Author: Hyun Yi @hyuunnn
Description: Attempt to change account password
EventId: 4723
Channel: "Security"
Provider: "Microsoft-Windows-Security-Auditing"
Maps:
  -
    Property: PayloadData1
    PropertyValue: "TargetUserName: %TargetUserName%"
    Values:
      -
        Name: TargetUserName
        Value: "/Event/EventData/Data[@Name=\"TargetUserName\"]"
  -
    Property: PayloadData2
    PropertyValue: "TargetDomainName: %TargetDomainName%"
    Values:
      -
        Name: TargetDomainName
        Value: "/Event/EventData/Data[@Name=\"TargetDomainName\"]"
  -
    Property: PayloadData3
    PropertyValue: "TargetSid: %TargetSid%"
    Values:
      -
        Name: TargetSid
        Value: "/Event/EventData/Data[@Name=\"TargetSid\"]"
  -
    Property: PayloadData4
    PropertyValue: "SubjectUserSid: %SubjectUserSid%"
    Values:
      -
        Name: SubjectUserSid
        Value: "/Event/EventData/Data[@Name=\"SubjectUserSid\"]"
  -
    Property: PayloadData5
    PropertyValue: "SubjectUserName: %SubjectUserName%"
    Values:
      -
        Name: SubjectUserName
        Value: "/Event/EventData/Data[@Name=\"SubjectUserName\"]"

  -
    Property: PayloadData6
    PropertyValue: "SubjectDomainName: %SubjectDomainName%"
    Values:
      -
        Name: SubjectDomainName
        Value: "/Event/EventData/Data[@Name=\"SubjectDomainName\"]"
        
# Valid properties include:

# <Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
#   <System>
#     <Provider Name="Microsoft-Windows-Security-Auditing" Guid="{GUID}" /> 
#     <EventID>4723</EventID> 
#     <Version>0</Version> 
#     <Level>0</Level> 
#     <Task>13824</Task> 
#     <Opcode>0</Opcode> 
#     <Keywords>0x8020000000000000</Keywords> 
#     <TimeCreated SystemTime="2020-12-06T09:54:38.1053830Z" /> 
#     <EventRecordID>217497</EventRecordID> 
#     <Correlation ActivityID="{ActivityID}" /> 
#     <Execution ProcessID="740" ThreadID="3868" /> 
#     <Channel>Security</Channel> 
#     <Computer>ComputerName</Computer> 
#     <Security /> 
#   </System>
#   <EventData>
#     <Data Name="TargetUserName">hyuunnn</Data> 
#     <Data Name="TargetDomainName">ComputerName</Data> 
#     <Data Name="TargetSid">{TargetSid}</Data> 
#     <Data Name="SubjectUserSid">{SubjectUserSid}</Data> 
#     <Data Name="SubjectUserName">hyuunnn</Data> 
#     <Data Name="SubjectDomainName">ComputerName</Data> 
#     <Data Name="SubjectLogonId">0x1ea14</Data> 
#     <Data Name="PrivilegeList">-</Data> 
#   </EventData>
# </Event>